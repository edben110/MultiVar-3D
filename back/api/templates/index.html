{% load static %}

<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>MultiVar 3D</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
</head>
<body>
  <div id="panel">
    <div class="panel-header">
      <h3>MultiVar 3D</h3>
      <button id="themeToggle" class="theme-toggle-btn" title="Cambiar tema">
        <span class="theme-icon">üåô</span>
      </button>
    </div>
    
    <div class="input-group">
      <label for="expr">Funci√≥n matem√°tica (usa x, y, z)</label>
      <input id="expr" placeholder="Ej: x^2 + y^2 + z^2" value="x^2 + y^2">
      <div class="example-buttons">
        <button class="example-btn" data-expr="x^2 + y^2" data-iso="0">Paraboloide</button>
        <button class="example-btn" data-expr="x^2 - y^2" data-iso="0">Silla de montar</button>
        <button class="example-btn" data-expr="x^2 + y^2 + z^2" data-iso="9">Esfera (r=3)</button>
        <button class="example-btn" data-expr="sin(x) + cos(y)" data-iso="0">Onda</button>
        <button class="example-btn" data-expr="x^2 + y^2 - z^2" data-iso="0">Hiperboloide</button>
        <button class="example-btn" data-expr="sqrt(x^2 + y^2) - z" data-iso="0">Cono</button>
      </div>
    </div>
    
    <div class="input-group">
      <label for="op">Operaci√≥n</label>
      <select id="op">
        <option value="superficie">Graficar superficie</option>
        <option value="derivada_x">Derivada parcial respecto a x</option>
        <option value="derivada_y">Derivada parcial respecto a y</option>
        <option value="derivada_z">Derivada parcial respecto a z</option>
        <option value="integral_doble">Integral doble</option>
        <option value="integral_triple">Integral triple</option>
        <option value="dominio_rango">Dominio y rango (estimado)</option>
        <option value="limite">L√≠mite en (a,b)</option>
        <option value="gradiente">Gradiente en (x0,y0)</option>
        <option value="lagrange">Optimizaci√≥n con Lagrange</option>
      </select>
    </div>

    <!-- Contenedor para inputs din√°micos seg√∫n operaci√≥n -->
    <div id="op-params" class="input-group" style="display:none;">
      <!-- se rellenar√° con JS -->
    </div>
    
    <button id="btnCalcular" class="btn-primary">
      <span class="btn-icon">üìä</span>
      Calcular
    </button>
    
    <div id="resultado" class="resultado"></div>
  </div>

  <script src="{% static 'dist/bundle.js' %}"></script>
  <script>
const opSelect = document.getElementById('op');
const opParams = document.getElementById('op-params');

const paramTemplates = {
  limite: `
    <label>a (x ‚Üí a)</label><input id="a" value="0">
    <label>b (y ‚Üí b)</label><input id="b" value="0">
  `,
  lagrange: `
    <label>Restricci√≥n g(x,y)</label><input id="g" value="x^2 + y^2">
    <label>Constante c</label><input id="c" value="1">
  `,
  superficie: `
    <label>Rango X</label>
    <input name="xmin" placeholder="xmin (ej: -3)" value="-3" />
    <input name="xmax" placeholder="xmax (ej: 3)" value="3" />
    <label>Rango Y</label>
    <input name="ymin" placeholder="ymin (ej: -3)" value="-3" />
    <input name="ymax" placeholder="ymax (ej: 3)" value="3" />
    <label>Rango Z (para funciones impl√≠citas)</label>
    <input name="zmin" placeholder="zmin (ej: -3)" value="-3" />
    <input name="zmax" placeholder="zmax (ej: 3)" value="3" />
    <label>Resoluci√≥n (nx, ny, nz)</label>
    <input name="nx" placeholder="nx (ej: 40)" value="40" />
    <input name="ny" placeholder="ny (ej: 40)" value="40" />
    <input name="nz" placeholder="nz (ej: 40)" value="40" />
    <label>Isovalor (para funciones impl√≠citas)</label>
    <input name="iso_value" placeholder="iso_value (ej: 0)" value="0" />
    <small>Para esferas usa: x^2+y^2+z^2 con iso_value=9 (radio 3)</small>
  `
};

opSelect.addEventListener('change', () => {
  const op = opSelect.value;
  if (paramTemplates[op]) {
    opParams.style.display = 'block';
    opParams.innerHTML = paramTemplates[op];
  } else {
    opParams.style.display = 'none';
    opParams.innerHTML = '';
  }
});
document.addEventListener('DOMContentLoaded', () => {
  const opSelect = document.getElementById('op');
  const paramsDiv = document.getElementById('op-params');

  opSelect.addEventListener('change', () => {
    const op = opSelect.value;
    paramsDiv.innerHTML = ''; // limpia anteriores
    paramsDiv.style.display = 'none';

    if (op === 'limite') {
      paramsDiv.style.display = 'block';
      paramsDiv.innerHTML = `
        <label for="a">a:</label><input id="a" type="number" value="0">
        <label for="b">b:</label><input id="b" type="number" value="0">
      `;
    }

    if (op === 'gradiente') {
      paramsDiv.style.display = 'block';
      paramsDiv.innerHTML = `
        <label for="x0">x‚ÇÄ:</label><input id="x0" type="number" value="0">
        <label for="y0">y‚ÇÄ:</label><input id="y0" type="number" value="0">
      `;
    }

    if (op === 'lagrange') {
      paramsDiv.style.display = 'block';
      paramsDiv.innerHTML = `
        <label for="g">Funci√≥n objetivo g(x,y):</label>
        <input id="g" placeholder="Ej: x^2 + y^2">
        <label for="c">Restricci√≥n c(x,y)=0:</label>
        <input id="c" placeholder="Ej: x + y - 1">
      `;
    }
  });
});

function showOpParamsFor(op) {
    clearOpParams();
    if (op === 'limite') {
        opParams.style.display = 'block';
        opParams.innerHTML = `
            <label>a (x ‚Üí a)</label><input id="a" value="0">
            <label>b (y ‚Üí b)</label><input id="b" value="0">
        `;
    } else if (op === 'gradiente') {
        opParams.style.display = 'block';
        opParams.innerHTML = `
            <label for="x0">x‚ÇÄ:</label><input id="x0" type="number" value="0">
            <label for="y0">y‚ÇÄ:</label><input id="y0" type="number" value="0">
        `;
    } else if (op === 'lagrange') {
        opParams.style.display = 'block';
        opParams.innerHTML = `
            <label>Restricci√≥n g(x,y)</label><input id="g" value="x^2 + y^2">
            <label>Constante c</label><input id="c" value="1">
        `;
    } else if (op === 'superficie') {
        opParams.style.display = 'block';
        opParams.innerHTML = `
            <label>Rango X</label>
            <input name="xmin" placeholder="xmin (ej: -3)" value="-3" />
            <input name="xmax" placeholder="xmax (ej: 3)" value="3" />
            <label>Rango Y</label>
            <input name="ymin" placeholder="ymin (ej: -3)" value="-3" />
            <input name="ymax" placeholder="ymax (ej: 3)" value="3" />
            <label>Rango Z (para funciones impl√≠citas)</label>
            <input name="zmin" placeholder="zmin (ej: -3)" value="-3" />
            <input name="zmax" placeholder="zmax (ej: 3)" value="3" />
            <label>Resoluci√≥n (nx, ny, nz)</label>
            <input name="nx" placeholder="nx (ej: 50)" value="50" />
            <input name="ny" placeholder="ny (ej: 50)" value="50" />
            <input name="nz" placeholder="nz (ej: 50)" value="50" />
            <label>Isovalor (para funciones impl√≠citas)</label>
            <input name="iso_value" placeholder="iso_value (ej: 0)" value="0" />
            <small>Mayor resoluci√≥n = superficies m√°s suaves (recomendado: 50-60)</small>
        `;
    } else {
        clearOpParams();
    }
}

// Ejecutar al cambiar operaci√≥n
opSelect.addEventListener('change', (e) => {
    showOpParamsFor(e.target.value);
});

// Inicializar con la operaci√≥n actual
showOpParamsFor(opSelect.value);

</script>
</body>
</html>
